This is the source code behind <https://www.huber.embl.de/group/>, a static directory of HTML files (and resources they require).

The following is a set of instructions for group members on how to build their own instance locally, update content, and upload to the server.


# One time actions

## Install Quarto 

Please see here: <https://quarto.org/>

## Install the webr extension for Quarto

Run

```
quarto add coatless/quarto-webr
```

See here for more on this: <https://github.com/coatless/quarto-webr>.

# To make webpage updates

## Update your local codebase

```
git pull
```

## Edit

Add new files or edit existing ones. 

## Render 

To build the website, run

```
quarto render
```

in the top-level directory of this repository.
A directory of "static" HTML files will be created in the `_site` folder.

## Upload to EMBL's webserver

Check <minio-README.md>

## Update the codebase in git

Use `git add`, `git commit`, and finally `git push`.

# Adding publications to the publication page

This repository stores the data used to generate [Huber Group Publications](https://www.huber.embl.de/publications/). An automated job updates that page with current citation counts on a weekly basis.

## What should be included

The page is supposed to be a summary of the output generated by the group.  For most people, if you publish anything while you're in the group, or someone's work done during this time gets published after they leave, that should be included. 

If something is published while you're in the Huber Group, but your contribution to the publication was prior to joining us, then don't include it.

The line can get a bit blurred with long-term projects, paper revisions, or for those of us who span multiple groups. If in doubt, ask Wolfgang.

## Instructions to add a new entry

1. Put a PDF copy of your paper on the Huber group shared drive under `/g/huber/www-huber/pub/pdf`.  Preferably name the PDF `<SURNAME>-<JOURNAL>-<YEAR>.pdf`.  There are lots of ways to do this; I would run the following command:

```
scp <FILENAME.pdf> <EMBL_USERNAME>@datatransfer.embl.de:/g/huber/www-huber/pub/pdf/
```

2. Create a new branch of this Git repository. You can call the new branch anything you like.

3. Create a BibTex entry for your publication in `lop.bib`.  I like to use [Semantic Scholar](https://www.semanticscholar.org/) to obtain this because it has an easy to copy/paste Bibtex pop-up, but any citation service should be fine.  Please try to ensure the following:
  - Name the entry with `<SURNAME>:<JOURNAL>:<YEAR>`
  - If there are co-first authors mark these with `\cofirst` immediately after the surname e.g. `Smits\cofirst, Arne H. and Ziebell\cofirst, Frederik`
  - If there are co-corresponding authors mark these with `\cocorr` after the surnames e.g. `Wolfgang Huber\cocorr and Thorsten Zenz\cocorr`.
  - Include the DOI of the journal publication
  - Include the DOI of the preprint (note that preprints are mandatory for EMBL-led papers)
  - Include the URL at https://europepmc.org/
  - Add a PDF entry with the name of the PDF file you placed on the shared drive.
  - Try to include a publication month if available.
  - If the title has letters that should remain capitalised e.g. `RNA-Seq` ensure they are wrapped in additional curly brackets e.g. `{RNA-Seq}`.
  - If the publication was previously published as a pre-print add an `addendum` field to the new record using the format below.  You can remove the pre-print record in `lop.bib` if one exists.
```
Addendum = {\href{https://WWW.PREPRINT.COM/PAPER}{Preprint on {bioR$\chi$iv}}}
```

4. Add the ID of your new BibTex record to `index.tex`.  The entries are grouped by year, and ideally sorted by online publication date with the most recent entry coming first.  Find the appropriate year and add the record ID for your new paper.  Record IDs must be separated by a comma.  If a pre-print of your paper is already listed somewhere in this file, please remove the entry for the pre-print e.g. 

```latex
%2021 sorted by online pub data
\nocite{%
Ignatiadis:JRSSB:2021,
Smith:Arxiv:2021}
```

might become

```latex
%2021 sorted by online pub data
\nocite{%
Smith:Bioinformatics:2021,
Ignatiadis:JRSSB:2021}
```

5. Ensure your name appears in `group_members.csv`.  There is one line per Huber Group member, and typically you won't need to change this once your name is here.  However the details here are used to highlight group members, and you may need to modify the entry depending on how the author names are formatted in `lop.bib` (e.g. M. Smith vs Mike Smith) or if a co-author of a recent paper is a former member of the lab.

6. Commit the updated files to the Git repository.

7. Check the status of the build at https://github.com/Huber-group-EMBL/Huber-group-EMBL.github.io/actions. The pipeline typically takes a few minutes to run.  If you see a failure you can click on the jobs to see the output; hopefully there's a helpful error message.

8. Create a merge-request using the "create merge request" button.

9. Send an email to [miriam.mueller@embl.de](mailto:miriam.mueller@embl.de) or [msmith@embl.de](mailto:msmith@embl.de) in case we don't get anything automatically and we will merge your changes to the master branch; this will then update the main group website.